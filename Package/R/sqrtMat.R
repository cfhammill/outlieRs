#####################################################################################################
## function to calculate cov^(-1/2) ##
#####################################################################################################
sqrtMat <- function(x, n){
  with(eigen(x), vectors %*% (values^n * t(vectors)))
}
